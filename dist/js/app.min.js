"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}var body=document.body,toggleBtn=document.querySelector(".calc__upper-right-toggle-btn"),toggleCircle=document.querySelector(".calc__upper-right-toggle-btn::before"),displayEl=document.querySelector(".calc__screen-display"),numberKeys=document.querySelectorAll("[data-number]"),operandKeys=document.querySelectorAll("[data-operand]"),equalsKey=document.querySelector("[data-equals]"),resetKey=document.querySelector("[data-reset]"),deleteKey=document.querySelector("[data-delete]"),Calculator=function(){function e(){var t=this;_classCallCheck(this,e),_defineProperty(this,"toggleState",1),_defineProperty(this,"currentNumber",""),_defineProperty(this,"previousNumber",0),_defineProperty(this,"lastOperationNum",0),_defineProperty(this,"currentOperand",void 0),_defineProperty(this,"isLastOperationEqual",!1),toggleBtn.addEventListener("click",this.toggle.bind(this)),numberKeys.forEach(function(e){return e.addEventListener("click",t.addNum.bind(t))}),operandKeys.forEach(function(e){return e.addEventListener("click",t.doOperation.bind(t))}),deleteKey.addEventListener("click",this.delete.bind(this)),equalsKey.addEventListener("click",this.equals.bind(this)),resetKey.addEventListener("click",this.reset.bind(this))}return _createClass(e,[{key:"toggle",value:function(){toggleBtn.classList.remove("second-state","third-state"),this.toggleState++,4===this.toggleState&&(this.toggleState=1),2===this.toggleState&&toggleBtn.classList.add("second-state"),3===this.toggleState&&toggleBtn.classList.add("third-state"),document.documentElement.setAttribute("data-theme","theme-".concat(this.toggleState))}},{key:"displayNum",value:function(){""===this.currentNumber?displayEl.textContent=0:displayEl.textContent=this.currentNumber}},{key:"addNum",value:function(e){e=e.target.textContent;13<=this.currentNumber.length||"."===e&&this.currentNumber.includes(".")||0==+e&&0==+this.currentNumber||(this.currentNumber+=e,this.displayNum(),console.log("addNum"),console.log("Previous: ".concat(this.previousNumber," ").concat(_typeof(this.previousNumber))),console.log("Current: ".concat(this.currentNumber," ").concat(_typeof(this.currentNumber))),console.log(""))}},{key:"delete",value:function(){this.currentNumber=String(this.currentNumber).slice(0,-1),this.displayNum()}},{key:"doOperation",value:function(e){this.previousNumber&&this.currentNumber&&this.equals(),(this.currentOperand!==e.target.textContent||this.LastOperationIsEqual)&&(this.LastOperationIsEqual=!1,this.currentOperand=e.target.textContent,this.currentNumber)&&(this.previousNumber,this.previousNumber=this.currentNumber,this.currentNumber="",console.log("doOperation"),console.log("Previous: ".concat(this.previousNumber," ").concat(_typeof(this.previousNumber))),console.log("Current: ".concat(this.currentNumber," ").concat(_typeof(this.currentNumber))),console.log(""))}},{key:"handleOperations",value:function(e,t){"+"===this.currentOperand&&(this.currentNumber=+e+ +t),"-"===this.currentOperand&&(this.currentNumber=+e-+t),"x"===this.currentOperand&&(this.currentNumber=+e*+t),"/"===this.currentOperand&&(this.currentNumber=+e/+t),this.currentNumber=String(this.currentNumber)}},{key:"equals",value:function(){this.LastOperationIsEqual||this.LastOperationIsEqual||(this.lastOperationNum=this.currentNumber,this.handleOperations(this.previousNumber,this.currentNumber)),this.previousNumber=0,this.LastOperationIsEqual&&(console.log(this.lastOperationNum),this.handleOperations(this.currentNumber,this.lastOperationNum)),this.displayNum(),console.log("equals"),console.log("Previous: ".concat(this.previousNumber," ").concat(_typeof(this.previousNumber))),console.log("Current: ".concat(this.currentNumber," ").concat(_typeof(this.currentNumber))),this.LastOperationIsEqual=!0,console.log("")}},{key:"reset",value:function(){this.toggleState=1,this.currentNumber="",this.previousNumber=0,this.lastOperationNum=0,this.currentOperand,this.isLastOperationEqual=!1,displayEl.textContent=0}}]),e}(),calculator=new Calculator;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJfdHlwZW9mIiwibyIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiY29uc3RydWN0b3IiLCJwcm90b3R5cGUiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2RlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJfdG9Qcm9wZXJ0eUtleSIsImtleSIsIl9jcmVhdGVDbGFzcyIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsIl9kZWZpbmVQcm9wZXJ0eSIsIm9iaiIsInZhbHVlIiwidCIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsInIiLCJlIiwidG9QcmltaXRpdmUiLCJOdW1iZXIiLCJjYWxsIiwiYm9keSIsInRvZ2dsZUJ0biIsInRvZ2dsZUNpcmNsZSIsImRpc3BsYXlFbCIsInF1ZXJ5U2VsZWN0b3IiLCJudW1iZXJLZXlzIiwicXVlcnlTZWxlY3RvckFsbCIsImRvY3VtZW50Iiwib3BlcmFuZEtleXMiLCJDYWxjdWxhdG9yIiwidGhpcyIsInRvZ2dsZSIsImJpbmQiLCJfdGhpcyIsImFkZE51bSIsImRvT3BlcmF0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVxdWFsc0tleSIsInJlc2V0S2V5IiwicmVzZXQiLCJkZWxldGVLZXkiLCJ0b2dnbGVTdGF0ZSIsImFkZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImRvY3VtZW50RWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImN1cnJlbnROdW1iZXIiLCJ0ZXh0Q29udGVudCIsIm51bSIsImluY2x1ZGVzIiwiZGlzcGxheU51bSIsImNvbnNvbGUiLCJjb25jYXQiLCJwcmV2aW91c051bWJlciIsImxvZyIsInNsaWNlIiwiZXF1YWxzIiwiY3VycmVudE9wZXJhbmQiLCJMYXN0T3BlcmF0aW9uSXNFcXVhbCIsInByZXZpb3VzT3BlcmF0aW9uTnVtYmVyIiwib3BlcmF0aW9uTnVtYmVyIiwibGFzdE9wZXJhdGlvbk51bSIsImhhbmRsZU9wZXJhdGlvbnMiLCJpc0xhc3RPcGVyYXRpb25FcXVhbCIsImNhbGN1bGF0b3IiXSwibWFwcGluZ3MiOiJBQUFBLGFBQVksU0FBQUEsUUFBQUMsR0FBQSxPQUFBRCxRQUFBLFlBQUEsT0FBQUUsUUFBQSxVQUFBLE9BQUFBLE9BQUFDLFNBQUEsU0FBQUYsR0FBQSxPQUFBLE9BQUFBLENBQUEsRUFBQSxTQUFBQSxHQUFBLE9BQUFBLEdBQUEsWUFBQSxPQUFBQyxRQUFBRCxFQUFBRyxjQUFBRixRQUFBRCxJQUFBQyxPQUFBRyxVQUFBLFNBQUEsT0FBQUosQ0FBQSxHQUFBQSxDQUFBLENBQUEsQ0FBQSxTQUFBSyxnQkFBQUMsRUFBQUMsR0FBQSxHQUFBLEVBQUFELGFBQUFDLEdBQUEsTUFBQSxJQUFBQyxVQUFBLG1DQUFBLENBQUEsQ0FBQSxTQUFBQyxrQkFBQUMsRUFBQUMsR0FBQSxJQUFBLElBQUFDLEVBQUEsRUFBQUEsRUFBQUQsRUFBQUUsT0FBQUQsQ0FBQSxHQUFBLENBQUEsSUFBQUUsRUFBQUgsRUFBQUMsR0FBQUUsRUFBQUMsV0FBQUQsRUFBQUMsWUFBQSxDQUFBLEVBQUFELEVBQUFFLGFBQUEsQ0FBQSxFQUFBLFVBQUFGLElBQUFBLEVBQUFHLFNBQUEsQ0FBQSxHQUFBQyxPQUFBQyxlQUFBVCxFQUFBVSxlQUFBTixFQUFBTyxHQUFBLEVBQUFQLENBQUEsQ0FBQSxDQUFBLENBQUEsU0FBQVEsYUFBQWYsRUFBQWdCLEVBQUFDLEdBQUEsT0FBQUQsR0FBQWQsa0JBQUFGLEVBQUFILFVBQUFtQixDQUFBLEVBQUFDLEdBQUFmLGtCQUFBRixFQUFBaUIsQ0FBQSxFQUFBTixPQUFBQyxlQUFBWixFQUFBLFlBQUEsQ0FBQVUsU0FBQSxDQUFBLENBQUEsQ0FBQSxFQUFBVixDQUFBLENBQUEsU0FBQWtCLGdCQUFBQyxFQUFBTCxF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RUFEWEEsUUFJQUEsSUFBUUcsUUFBRyxFQUhYSCxRQUlLTyxJQUFBQSxhQUFBQSxPQUNPN0IsS0FBR3dCLGVBQUEsR0FBQSxFQUFBRCxPQUFBdEUsUUFBQStDLEtBQUF3QixjQUFBLENBQUEsQ0FDakIsRUFBQ0YsUUFBQUcsSUFBQSxZQUFBRixPQUFBdkIsS0FBQWlCLGNBQUEsR0FBQSxFQUFBTSxPQUFBdEUsUUFBQStDLEtBQUFpQixhQUFBLENBQUEsQ0FBQSxFQUFBMUMsS0FBQXNELHFCQUFBLENBQUEsRUFBQWhELFFBRUQ0QyxJQUFBLEVBQUEsQ0FGQSxDQUFDLEVBQUEsQ0FBQWxELElBQUEsUUFBQU0sTUFFRCxXQUNFbUIsS0FHQVcsWUFBS3FCLEVBRkxoQyxLQUdBaUIsY0FBbUIsR0FGbkJqQixLQUdBd0IsZUFBS1UsRUFGTGxDLEtBR0FQLGlCQUFxQixFQUN2Qk8sS0FBQTRCLGVBQUM1QixLQUFBa0MscUJBQUEsQ0FBQSxFQUFBekMsVUFBQU0sWUFBQSxDQUFBLENBQUEsRUFBQSxFQUFBQSxDQUFBLEVBQUEsRUFHR29DLFdBQWEsSUFBSXBDIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbmNvbnN0IGJvZHkgPSBkb2N1bWVudC5ib2R5O1xyXG5jb25zdCB0b2dnbGVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhbGNfX3VwcGVyLXJpZ2h0LXRvZ2dsZS1idG5cIik7XHJcbmNvbnN0IHRvZ2dsZUNpcmNsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIuY2FsY19fdXBwZXItcmlnaHQtdG9nZ2xlLWJ0bjo6YmVmb3JlXCJcclxuKTtcclxuY29uc3QgZGlzcGxheUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYWxjX19zY3JlZW4tZGlzcGxheVwiKTtcclxuY29uc3QgbnVtYmVyS2V5cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1udW1iZXJdXCIpO1xyXG5jb25zdCBvcGVyYW5kS2V5cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS1vcGVyYW5kXVwiKTtcclxuY29uc3QgZXF1YWxzS2V5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWVxdWFsc11cIik7XHJcbmNvbnN0IHJlc2V0S2V5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLXJlc2V0XVwiKTtcclxuY29uc3QgZGVsZXRlS2V5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIltkYXRhLWRlbGV0ZV1cIik7XHJcblxyXG5jbGFzcyBDYWxjdWxhdG9yIHtcclxuICB0b2dnbGVTdGF0ZSA9IDE7XHJcbiAgY3VycmVudE51bWJlciA9IFwiXCI7XHJcbiAgcHJldmlvdXNOdW1iZXIgPSAwO1xyXG4gIGxhc3RPcGVyYXRpb25OdW0gPSAwO1xyXG4gIGN1cnJlbnRPcGVyYW5kO1xyXG4gIGlzTGFzdE9wZXJhdGlvbkVxdWFsID0gZmFsc2U7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0b2dnbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMudG9nZ2xlLmJpbmQodGhpcykpO1xyXG4gICAgbnVtYmVyS2V5cy5mb3JFYWNoKChrZXkpID0+XHJcbiAgICAgIGtleS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5hZGROdW0uYmluZCh0aGlzKSlcclxuICAgICk7XHJcbiAgICBvcGVyYW5kS2V5cy5mb3JFYWNoKChrZXkpID0+XHJcbiAgICAgIGtleS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5kb09wZXJhdGlvbi5iaW5kKHRoaXMpKVxyXG4gICAgKTtcclxuICAgIGRlbGV0ZUtleS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5kZWxldGUuYmluZCh0aGlzKSk7XHJcbiAgICBlcXVhbHNLZXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuZXF1YWxzLmJpbmQodGhpcykpO1xyXG4gICAgcmVzZXRLZXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMucmVzZXQuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGUoKSB7XHJcbiAgICB0b2dnbGVCdG4uY2xhc3NMaXN0LnJlbW92ZShcInNlY29uZC1zdGF0ZVwiLCBcInRoaXJkLXN0YXRlXCIpO1xyXG4gICAgdGhpcy50b2dnbGVTdGF0ZSsrO1xyXG4gICAgaWYgKHRoaXMudG9nZ2xlU3RhdGUgPT09IDQpIHRoaXMudG9nZ2xlU3RhdGUgPSAxO1xyXG4gICAgaWYgKHRoaXMudG9nZ2xlU3RhdGUgPT09IDIpIHtcclxuICAgICAgdG9nZ2xlQnRuLmNsYXNzTGlzdC5hZGQoXCJzZWNvbmQtc3RhdGVcIik7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy50b2dnbGVTdGF0ZSA9PT0gMykge1xyXG4gICAgICB0b2dnbGVCdG4uY2xhc3NMaXN0LmFkZChcInRoaXJkLXN0YXRlXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zZXRBdHRyaWJ1dGUoXHJcbiAgICAgIFwiZGF0YS10aGVtZVwiLFxyXG4gICAgICBgdGhlbWUtJHt0aGlzLnRvZ2dsZVN0YXRlfWBcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBkaXNwbGF5TnVtKCkge1xyXG4gICAgaWYgKHRoaXMuY3VycmVudE51bWJlciA9PT0gXCJcIikge1xyXG4gICAgICBkaXNwbGF5RWwudGV4dENvbnRlbnQgPSAwO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkaXNwbGF5RWwudGV4dENvbnRlbnQgPSB0aGlzLmN1cnJlbnROdW1iZXI7XHJcbiAgfVxyXG5cclxuICBhZGROdW0oZSkge1xyXG4gICAgY29uc3QgbnVtID0gZS50YXJnZXQudGV4dENvbnRlbnQ7XHJcbiAgICBpZiAodGhpcy5jdXJyZW50TnVtYmVyLmxlbmd0aCA+PSAxMykgcmV0dXJuO1xyXG4gICAgaWYgKG51bSA9PT0gXCIuXCIgJiYgdGhpcy5jdXJyZW50TnVtYmVyLmluY2x1ZGVzKFwiLlwiKSkgcmV0dXJuO1xyXG4gICAgaWYgKCtudW0gPT09IDAgJiYgK3RoaXMuY3VycmVudE51bWJlciA9PT0gMCkgcmV0dXJuO1xyXG4gICAgdGhpcy5jdXJyZW50TnVtYmVyICs9IG51bTtcclxuICAgIC8vIHRoaXMuY3VycmVudE9wZXJhbmQgPSBudWxsO1xyXG4gICAgdGhpcy5kaXNwbGF5TnVtKCk7XHJcbiAgICBjb25zb2xlLmxvZyhcImFkZE51bVwiKTtcclxuICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICBgUHJldmlvdXM6ICR7dGhpcy5wcmV2aW91c051bWJlcn0gJHt0eXBlb2YgdGhpcy5wcmV2aW91c051bWJlcn1gXHJcbiAgICApO1xyXG4gICAgY29uc29sZS5sb2coYEN1cnJlbnQ6ICR7dGhpcy5jdXJyZW50TnVtYmVyfSAke3R5cGVvZiB0aGlzLmN1cnJlbnROdW1iZXJ9YCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIlwiKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZSgpIHtcclxuICAgIHRoaXMuY3VycmVudE51bWJlciA9IFN0cmluZyh0aGlzLmN1cnJlbnROdW1iZXIpLnNsaWNlKDAsIC0xKTtcclxuICAgIHRoaXMuZGlzcGxheU51bSgpO1xyXG4gIH1cclxuXHJcbiAgZG9PcGVyYXRpb24oZSkge1xyXG4gICAgaWYgKHRoaXMucHJldmlvdXNOdW1iZXIgJiYgdGhpcy5jdXJyZW50TnVtYmVyKSB0aGlzLmVxdWFscygpO1xyXG4gICAgaWYgKFxyXG4gICAgICB0aGlzLmN1cnJlbnRPcGVyYW5kID09PSBlLnRhcmdldC50ZXh0Q29udGVudCAmJlxyXG4gICAgICAhdGhpcy5MYXN0T3BlcmF0aW9uSXNFcXVhbFxyXG4gICAgKVxyXG4gICAgICByZXR1cm47XHJcbiAgICB0aGlzLkxhc3RPcGVyYXRpb25Jc0VxdWFsID0gZmFsc2U7XHJcbiAgICB0aGlzLmN1cnJlbnRPcGVyYW5kID0gZS50YXJnZXQudGV4dENvbnRlbnQ7XHJcbiAgICBpZiAoIXRoaXMuY3VycmVudE51bWJlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5wcmV2aW91c051bWJlciA9PT0gMCkge1xyXG4gICAgICB0aGlzLnByZXZpb3VzTnVtYmVyID0gdGhpcy5jdXJyZW50TnVtYmVyO1xyXG4gICAgICB0aGlzLmN1cnJlbnROdW1iZXIgPSBcIlwiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gdGhpcy5lcXVhbHMoKTtcclxuICAgICAgdGhpcy5wcmV2aW91c051bWJlciA9IHRoaXMuY3VycmVudE51bWJlcjtcclxuICAgICAgdGhpcy5jdXJyZW50TnVtYmVyID0gXCJcIjtcclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKFwiZG9PcGVyYXRpb25cIik7XHJcbiAgICBjb25zb2xlLmxvZyhcclxuICAgICAgYFByZXZpb3VzOiAke3RoaXMucHJldmlvdXNOdW1iZXJ9ICR7dHlwZW9mIHRoaXMucHJldmlvdXNOdW1iZXJ9YFxyXG4gICAgKTtcclxuICAgIGNvbnNvbGUubG9nKGBDdXJyZW50OiAke3RoaXMuY3VycmVudE51bWJlcn0gJHt0eXBlb2YgdGhpcy5jdXJyZW50TnVtYmVyfWApO1xyXG4gICAgY29uc29sZS5sb2coXCJcIik7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVPcGVyYXRpb25zKHByZXZpb3VzT3BlcmF0aW9uTnVtYmVyLCBvcGVyYXRpb25OdW1iZXIpIHtcclxuICAgIGlmICh0aGlzLmN1cnJlbnRPcGVyYW5kID09PSBcIitcIikge1xyXG4gICAgICB0aGlzLmN1cnJlbnROdW1iZXIgPSArcHJldmlvdXNPcGVyYXRpb25OdW1iZXIgKyArb3BlcmF0aW9uTnVtYmVyO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuY3VycmVudE9wZXJhbmQgPT09IFwiLVwiKSB7XHJcbiAgICAgIHRoaXMuY3VycmVudE51bWJlciA9ICtwcmV2aW91c09wZXJhdGlvbk51bWJlciAtICtvcGVyYXRpb25OdW1iZXI7XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5jdXJyZW50T3BlcmFuZCA9PT0gXCJ4XCIpIHtcclxuICAgICAgdGhpcy5jdXJyZW50TnVtYmVyID0gK3ByZXZpb3VzT3BlcmF0aW9uTnVtYmVyICogK29wZXJhdGlvbk51bWJlcjtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLmN1cnJlbnRPcGVyYW5kID09PSBcIi9cIikge1xyXG4gICAgICB0aGlzLmN1cnJlbnROdW1iZXIgPSArcHJldmlvdXNPcGVyYXRpb25OdW1iZXIgLyArb3BlcmF0aW9uTnVtYmVyO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jdXJyZW50TnVtYmVyID0gU3RyaW5nKHRoaXMuY3VycmVudE51bWJlcik7XHJcbiAgfVxyXG5cclxuICBlcXVhbHMoKSB7XHJcbiAgICBpZiAoIXRoaXMuTGFzdE9wZXJhdGlvbklzRXF1YWwpXHJcbiAgICAgIGlmICghdGhpcy5MYXN0T3BlcmF0aW9uSXNFcXVhbCkge1xyXG4gICAgICAgIHRoaXMubGFzdE9wZXJhdGlvbk51bSA9IHRoaXMuY3VycmVudE51bWJlcjtcclxuICAgICAgICB0aGlzLmhhbmRsZU9wZXJhdGlvbnModGhpcy5wcmV2aW91c051bWJlciwgdGhpcy5jdXJyZW50TnVtYmVyKTtcclxuICAgICAgfVxyXG4gICAgdGhpcy5wcmV2aW91c051bWJlciA9IDA7XHJcblxyXG4gICAgaWYgKHRoaXMuTGFzdE9wZXJhdGlvbklzRXF1YWwpIHtcclxuICAgICAgY29uc29sZS5sb2codGhpcy5sYXN0T3BlcmF0aW9uTnVtKTtcclxuICAgICAgdGhpcy5oYW5kbGVPcGVyYXRpb25zKHRoaXMuY3VycmVudE51bWJlciwgdGhpcy5sYXN0T3BlcmF0aW9uTnVtKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmRpc3BsYXlOdW0oKTtcclxuICAgIGNvbnNvbGUubG9nKFwiZXF1YWxzXCIpO1xyXG4gICAgY29uc29sZS5sb2coXHJcbiAgICAgIGBQcmV2aW91czogJHt0aGlzLnByZXZpb3VzTnVtYmVyfSAke3R5cGVvZiB0aGlzLnByZXZpb3VzTnVtYmVyfWBcclxuICAgICk7XHJcbiAgICBjb25zb2xlLmxvZyhgQ3VycmVudDogJHt0aGlzLmN1cnJlbnROdW1iZXJ9ICR7dHlwZW9mIHRoaXMuY3VycmVudE51bWJlcn1gKTtcclxuICAgIHRoaXMuTGFzdE9wZXJhdGlvbklzRXF1YWwgPSB0cnVlO1xyXG4gICAgY29uc29sZS5sb2coXCJcIik7XHJcbiAgfVxyXG5cclxuICByZXNldCgpIHtcclxuICAgIHRoaXMudG9nZ2xlU3RhdGUgPSAxO1xyXG4gICAgdGhpcy5jdXJyZW50TnVtYmVyID0gXCJcIjtcclxuICAgIHRoaXMucHJldmlvdXNOdW1iZXIgPSAwO1xyXG4gICAgdGhpcy5sYXN0T3BlcmF0aW9uTnVtID0gMDtcclxuICAgIHRoaXMuY3VycmVudE9wZXJhbmQ7XHJcbiAgICB0aGlzLmlzTGFzdE9wZXJhdGlvbkVxdWFsID0gZmFsc2U7XHJcbiAgICBkaXNwbGF5RWwudGV4dENvbnRlbnQgPSAwO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgY2FsY3VsYXRvciA9IG5ldyBDYWxjdWxhdG9yKCk7XHJcbiJdfQ==
